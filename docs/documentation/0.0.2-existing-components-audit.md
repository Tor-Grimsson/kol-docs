# Existing Components Audit

> **Created:** 2025-11-22
> **Purpose:** Document what's already built so we don't reinvent the wheel

---

## ğŸ¯ Summary

The wiki already has a sophisticated **block-based editing system** and **database views**. We don't need to rebuild - we need to **integrate** these existing systems with the markdown documentation.

---

## âœ… What Already Exists

### 1. **WikiComposer** (`/new`) - Block-Based Page Creator
**Location:** `src/pages/WikiComposer.jsx`

**What it does:**
- Visual block-based editor (like Notion!)
- Add blocks: heading, paragraph, list, code, callout, quote
- Live preview as you type
- Uses WikiBlockEditor + WikiBlockRenderer

**Block types available:**
- `heading` - H2, H3, H4
- `paragraph` - Text content
- `list` - Bullet lists
- `code` - Code blocks with language selector
- `callout` - Info/warning/accent boxes
- `quote` - Blockquotes with attribution
- `gallery` - Photo galleries

**How it works:**
1. Visit `/new`
2. Set title/subtitle
3. Click "+ Heading", "+ Paragraph", etc to add blocks
4. Edit blocks in the editor
5. See live preview below

**Current limitation:** Doesn't save to markdown files (outputs JSON blocks)

---

### 2. **WikiDatabases** (`/databases`) - Database Hub
**Location:** `src/pages/WikiDatabases.jsx`

**What it does:**
- Dashboard showing all databases/collections
- Filter by type (photos, yaml, pages, text, json)
- Search databases
- Action queue for tasks
- Timeline view
- Create new databases

**Data structure:** `src/data/databases.js`
- 3 databases already defined:
  - Media Archive (photos)
  - Token Docs (yaml)
  - Playbook Pages (pages)

**Each database has:**
- Name, type, status, owner
- Description, tags
- Pages (with blocks!)
- Tasks, timeline
- Multiple views (grid, table, timeline, kanban, etc.)

**How it works:**
1. Visit `/databases`
2. See all collections
3. Click a database to view detail (`/database/:id`)
4. Click a page within database (`/database/:id/page/:pageId`)

---

### 3. **WikiBlockEditor** - Visual Block Editor
**Location:** `src/components/WikiBlockEditor.jsx`

**What it does:**
- Virtualized list of editable blocks
- Each block type has custom UI
- onChange/onRemove handlers
- Height estimation for performance

**Supports:**
- Heading with level selector
- Paragraph textarea
- List (newline-separated)
- Code with language dropdown
- Callout with tone selector + title
- Quote with attribution

---

### 4. **WikiBlockRenderer** - Display Blocks
**Location:** `src/components/WikiBlockRenderer.jsx`

**What it does:**
- Renders blocks as HTML
- Maps block types to components
- Handles content normalization

**Used by:**
- WikiArticle (for viewing pages)
- WikiComposer (for preview)
- WikiDatabasePage (for database pages)

---

### 5. **WikiGallery** - Photo Gallery
**Location:** `src/components/WikiGallery.jsx`

**What it does:**
- Displays photo galleries
- Configurable spacing
- Uses react-window for performance

---

### 6. **Media Components**
**Location:** `src/components/media/`

- `MediaGallery.jsx` - Grid/mosaic view
- `MediaTable.jsx` - Sortable table view with @tanstack/react-table

**Used by:** `WikiMedia.jsx` page (`/media`)

---

### 7. **WikiInput** - Markdown Importer
**Location:** `src/pages/WikiInput.jsx`

**What it does:**
- Converts markdown to block JSON
- Input builder form
- Copy-to-clipboard output

---

## ğŸ”„ Integration Strategy

### Current State:
- **Documentation**: 137 markdown files (auto-loaded, read-only)
- **Databases**: 3 collections with block-based pages
- **Composer**: Creates block-based pages (not markdown)

### The Problem:
Two separate content systems:
1. Markdown files (documentation)
2. Block-based pages (databases, composer)

### The Solution:

**Option 1: Bridge the Gap** âœ… RECOMMENDED
- Keep markdown for documentation (137 files)
- Use WikiComposer for creating new pages
- Add "Export to Markdown" button to composer
- WikiComposer outputs markdown with frontmatter

**Option 2: Unified Block System**
- Convert all markdown to blocks on load
- Store everything as blocks
- Generate markdown on demand

---

## ğŸ› ï¸ What Needs To Happen

### âœ… Immediate (Connect Existing Systems) - COMPLETED

1. **âœ… Add Export to WikiComposer** - DONE
   - Created `blocksToMarkdown.js` utility
   - Added version number input (M.m.p)
   - Added "Download .md File" button
   - Added "Copy Markdown" button
   - Auto-generates filename from title
   - Creates proper frontmatter with title, version, date, status

### ğŸš§ Next Steps (Not Started):

2. **Wire Databases to Navigation**
   - Add database pages to main navigation
   - Show database content alongside documentation

3. **Enable Editing Markdown Files**
   - Load .md file content into WikiComposer
   - Parse markdown to blocks
   - Edit as blocks
   - Save back to markdown

### ğŸ”® Future (Full Integration):

4. **Bidirectional Sync**
   - Edit markdown files in composer
   - Composer auto-saves to .md format
   - Changes reflect immediately

5. **Database Templates**
   - Create databases for documentation categories
   - Each section (Foundation, Design System, etc.) is a database
   - Pages are database entries

---

## âœ¨ Latest Update (2025-11-22)

### WikiComposer Now Exports Markdown!

The WikiComposer now has full markdown export capability:

**New Features:**
- Version number input with M.m.p format
- Auto-generated filename preview
- "Download .md File" button â†’ saves to your computer
- "Copy Markdown" button â†’ copies to clipboard
- Proper frontmatter generation

**How to use:**
1. Go to `/new`
2. Create your page with blocks
3. Set version number (e.g., 1.0.0)
4. Click "Download .md File"
5. Save to `src/data/documentation/`
6. Refresh app to see new page in navigation

**Block â†’ Markdown Conversion:**
- Heading â†’ `## Heading`
- Paragraph â†’ Plain text
- List â†’ `- Item`
- Code â†’ ` ```language\ncode\n``` `
- Callout â†’ `> **Title**\n> Text`
- Quote â†’ `> Quote\n> â€” Attribution`

---

## ğŸ“Š Component Inventory

| Component | Location | Purpose | Status |
|-----------|----------|---------|--------|
| **Pages** | | | |
| WikiHome | `src/pages/` | Landing page | âœ… Active |
| WikiArticle | `src/pages/` | Display markdown docs | âœ… Active |
| WikiComposer | `src/pages/` | Block-based editor | âœ… Active (needs export) |
| WikiDatabases | `src/pages/` | Database hub | âœ… Active |
| WikiDatabaseDetail | `src/pages/` | Single database view | âœ… Active |
| WikiDatabasePage | `src/pages/` | Page within database | âœ… Active |
| WikiInput | `src/pages/` | MD â†’ JSON converter | âœ… Active |
| WikiMedia | `src/pages/` | Media library | âœ… Active |
| WikiEditor | `src/pages/` | Simple markdown editor | âš ï¸ New (redundant?) |
| | | | |
| **Components** | | | |
| WikiBlockEditor | `src/components/` | Edit blocks | âœ… Active |
| WikiBlockRenderer | `src/components/` | Render blocks | âœ… Active |
| WikiGallery | `src/components/` | Photo gallery | âœ… Active |
| WikiLayout | `src/components/` | 3-column layout | âœ… Active |
| WikiSidebar | `src/components/` | Left nav (old) | âš ï¸ Unused? |
| SidebarNav | `src/components/` | Left nav (new) | âœ… Active |
| DocsNavbar | `src/components/` | Top navbar | âœ… Active |
| MediaGallery | `src/components/media/` | Media grid view | âœ… Active |
| MediaTable | `src/components/media/` | Media table view | âœ… Active |
| | | | |
| **Docs Components** | | | |
| DocsArticle | `src/components/docs/` | Content wrapper | âœ… Active |
| DocsHeader | `src/components/docs/` | Headings (H1-H6) | âœ… Active |
| DocsCodeBlock | `src/components/docs/` | Code with copy button | âœ… Active |
| DocsPageHeader | `src/components/docs/` | Page header + breadcrumbs | âœ… Active |
| DocsToc | `src/components/docs/` | Table of contents | âœ… Active |
| DocsRailDrawer | `src/components/docs/` | Mobile drawer | âœ… Active |

---

## ğŸ¯ Recommendation

**DON'T** build WikiEditor (already did - it's redundant!)

**DO** enhance WikiComposer:
1. Add markdown export
2. Add markdown import
3. Wire to navigation
4. Make it the primary editing interface

**Result:** One unified system where you can:
- View 137 markdown docs
- Edit them in block editor
- Create new pages visually
- Everything saves as markdown
- Everything works like Notion

---

## ğŸ“ Next Steps

1. âœ… ~~Document WikiComposer usage in wiki~~ - DONE
2. âœ… ~~Add export button to WikiComposer~~ - DONE
3. â³ Wire databases into main navigation
4. â³ Add markdown import to WikiComposer (edit existing .md files)
5. â³ Consider removing redundant WikiEditor
6. âœ… ~~Update SITE-TREE.md with this information~~ - DONE

---

*This audit shows we already have 90% of what we need - we just connected the missing piece! WikiComposer is now a fully functional Notion-like editor that exports to markdown.*
