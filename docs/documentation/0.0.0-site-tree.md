# Wiki Status & Architecture

> **Status: FUNCTIONAL** âœ…
> **Last Updated:** 2025-11-22
> **Current Phase:** Core functionality complete, polish and features in progress

---

## ğŸ¯ Implementation Status

### âœ… COMPLETED

**Phase 1: Core Functionality**
- âœ… Markdown parser (137 files loaded)
- âœ… Auto-generated navigation from M.m.p file numbering
- âœ… Full markdown rendering (headings, lists, code, tables, links)
- âœ… Frontmatter parsing (title, version, date, status)
- âœ… Reference design layout (3-column: nav, content, TOC)
- âœ… Dark theme styling matching reference
- âœ… Heavy lifter components (DocsArticle, DocsHeader, DocsCodeBlock, DocsPageHeader)

**Working Features:**
- Browse all 137 documentation files
- Click navigation to view pages
- Markdown content rendered with styling
- Table of contents auto-generated from H2/H3
- Breadcrumb navigation
- Search filtering by title/slug
- Active page highlighting in sidebar

**Phase 2: Block-Based Editing (WikiComposer)**
- âœ… Block editor with live preview (heading, paragraph, list, code, callout, quote)
- âœ… Markdown export functionality (download .md files)
- âœ… Copy markdown to clipboard
- âœ… Version number input (M.m.p)
- âœ… Auto-generated filename from title

**Phase 2.5: Design System Application**
- âœ… Complete Kolkrabbi design system applied
- âœ… Fixed white-on-white text issue
- âœ… Applied bg-surface-primary, text-auto, bg-fg-08, border-fg-08
- âœ… Standardized ALL border-radius to 4px (ALWAYS)
- âœ… Applied kol-helper-xs typography (RightGrotesk Mono 12px)
- âœ… Complete utility classes (bg-fg-*, border-fg-*, text-fg-*)
- âœ… Replaced hard-coded colors with design tokens
- âœ… Configured via @theme in styles.css (Tailwind CSS v4)
- âœ… Deleted tailwind.config.js (not used in v4)

### ğŸš§ IN PROGRESS

**Phase 3: Enhancement**
- â³ Syntax highlighting for code blocks
- â³ Tree navigation with expand/collapse
- â³ Scroll spy for TOC active states
- â³ Mobile responsive drawer navigation

### ğŸ“‹ TODO (Not Started)

**Phase 4: Advanced Features**
- âŒ Markdown import to WikiComposer (edit existing .md files as blocks)
- âŒ Database integration (wire WikiDatabases to main nav)
- âŒ Full-text search across content
- âŒ Cross-reference system from frontmatter
- âŒ Keyboard navigation (arrows for prev/next)
- âŒ Hot reload on markdown file changes
- âŒ Validation scripts for broken links
- âŒ Light/dark theme toggle

---

## ğŸ“ Project Structure

```
/Users/biskup/git/kolkrabbi/kolkrabbi-docs/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ docs/              # Heavy lifter components
â”‚   â”‚   â”‚   â”œâ”€â”€ DocsArticle.jsx       âœ… Content wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ DocsHeader.jsx        âœ… Heading system (H1-H6)
â”‚   â”‚   â”‚   â”œâ”€â”€ DocsCodeBlock.jsx     âœ… Code with copy button
â”‚   â”‚   â”‚   â”œâ”€â”€ DocsPageHeader.jsx    âœ… Breadcrumbs + title
â”‚   â”‚   â”‚   â””â”€â”€ DocsToc.jsx           âœ… Table of contents
â”‚   â”‚   â”œâ”€â”€ DocsNavbar.jsx     âœ… Top navigation bar
â”‚   â”‚   â”œâ”€â”€ WikiLayout.jsx     âœ… 3-column layout
â”‚   â”‚   â”œâ”€â”€ SidebarNav.jsx     âœ… Left sidebar navigation
â”‚   â”‚   â”œâ”€â”€ WikiBlockEditor.jsx      âœ… Block-based editor (virtualized)
â”‚   â”‚   â””â”€â”€ WikiBlockRenderer.jsx    âœ… Block display component
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ WikiArticle.jsx    âœ… Article page renderer
â”‚   â”‚   â”œâ”€â”€ WikiComposer.jsx   âœ… Block-based page creator (NEW!)
â”‚   â”‚   â”œâ”€â”€ WikiDatabases.jsx  âœ… Database/collection hub
â”‚   â”‚   â””â”€â”€ WikiEditor.jsx     âš ï¸ Redundant (use WikiComposer)
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ markdownParser.js        âœ… Parse markdown + frontmatter
â”‚   â”‚   â”œâ”€â”€ simpleFrontmatter.js     âœ… YAML parser (browser-safe)
â”‚   â”‚   â”œâ”€â”€ loadDocs.js              âœ… Load all .md files, generate nav
â”‚   â”‚   â”œâ”€â”€ wikiSchema.js            âœ… Block types & normalization
â”‚   â”‚   â””â”€â”€ blocksToMarkdown.js      âœ… Convert blocks â†’ markdown (NEW!)
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ documentation/     ğŸ“š 137 markdown files (0.0.0 - 9.9.9)
â”‚   â”‚   â””â”€â”€ databases.js       ğŸ“š Database definitions
â”‚   â””â”€â”€ styles.css             âœ… Complete design system
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ documentation/
â”‚       â”œâ”€â”€ 0.0.0-site-tree.md       ğŸ“ This file
â”‚       â”œâ”€â”€ IMPLEMENTATION-PLAN.md   ğŸ“‹ Full roadmap
â”‚       â””â”€â”€ README.md
â””â”€â”€ package.json               âœ… Dependencies: marked, react-router-dom
```

---

## ğŸ› ï¸ How It Works

### Creating a New Page

**Option 1: Use WikiComposer (Visual Editor)** âœ¨ RECOMMENDED

1. Visit `/new` in the app
2. Enter title, subtitle, version number (M.m.p)
3. Add blocks: heading, paragraph, list, code, callout, quote
4. Click "ğŸ’¾ Download .md File" to export
5. Save file to `src/data/documentation/`
6. Refresh app to see new page

**Option 2: Manual Markdown File**

1. Add file to `src/data/documentation/`
2. Name format: `M.m.p-slug-name.md`
   - M = Major version (0-9)
   - m = Minor version
   - p = Patch version
   - Example: `1.2.3-my-feature.md`

3. Add frontmatter:
```markdown
---
title: My Feature Documentation
version: 1.0.0
date: 2025-11-22
status: active
---

# My Feature

Your markdown content here...
```

4. Save â†’ File automatically appears in navigation (sorted by version)

### Section Organization

Files are auto-grouped by major version:
- **0.x** = Meta (documentation about documentation)
- **1.x** = Foundation (repo structure, naming, build)
- **2.x** = Design System (colors, typography, CSS)
- **3.x** = Components (atoms, molecules, organisms)
- **4.x** = Pages (public pages, templates)
- **5.x** = Workshop (experiments, prototypes)
- **6.x** = Research (explorations, studies)
- **7.x** = Operations (workflows, protocols)
- **8.x** = Decisions (architecture decisions)
- **9.x** = Future (roadmap, proposals)

---

## ğŸ¨ Component Architecture

### Heavy Lifters (Core Components)

**DocsArticle** (`src/components/docs/DocsArticle.jsx`)
- Main content container
- Max-width 65ch for readability
- Prose styling context
- Vertical rhythm spacing

**DocsHeader** (`src/components/docs/DocsHeader.jsx`)
- Flexible H1-H6 headings
- Auto-generated anchor IDs from titles
- Subtitle and metadata support
- Hover shows # anchor link

**DocsCodeBlock** (`src/components/docs/DocsCodeBlock.jsx`)
- Language label display
- Copy-to-clipboard button with feedback
- Syntax highlighting ready (CSS classes)
- Line numbers support

**DocsPageHeader** (`src/components/docs/DocsPageHeader.jsx`)
- Breadcrumb navigation with links
- Page title display
- Metadata (version, date) display
- Clean separation from content

**DocsToc** (`src/components/docs/DocsToc.jsx`)
- Auto-generated from H2/H3 headings
- Scroll spy ready (TODO)
- Jump to section links

### Layout Components

**WikiLayout** (`src/components/WikiLayout.jsx`)
- 3-column grid: nav (280px), content (flexible), TOC (280px)
- Sticky navbar and sidebars
- Responsive (hides sidebars < 968px)
- Dark theme: #1a1a1d background

**DocsNavbar** (`src/components/DocsNavbar.jsx`)
- Logo, Documentation title, tabs, search
- Sticky at top
- Dark theme: #0f0f11 background

**SidebarNav** (`src/components/SidebarNav.jsx`)
- Displays sections from auto-generated navigation
- Shows version numbers (e.g., "1.0.0")
- Active state highlighting
- Search filtering

---

## ğŸš€ Running the Wiki

**Development:**
```bash
yarn dev
# â†’ http://localhost:5177/
```

**Build:**
```bash
yarn build
# â†’ dist/ folder (1.9MB with all 137 files)
```

**Dependencies:**
- `marked` - Markdown parsing
- `react-router-dom` - Routing
- `buffer` - Polyfill for browser
- No external CSS frameworks (custom design system)

---

## ğŸ“Š Metrics

- **Files:** 137 markdown documents
- **Sections:** 10 major categories (0.x - 9.x)
- **Components:** 11 React components
- **Build Time:** ~1.6s
- **Bundle Size:** 1.9MB (includes all docs)
- **CSS:** 757 lines (single file)

---

## ğŸ¯ Next Steps

### Immediate (Sprint 1)
1. Add syntax highlighting (Prism.js)
2. Implement tree navigation (collapsible sections)
3. Add scroll spy to TOC
4. Mobile drawer navigation

### Short Term (Sprint 2)
5. Full-text search with fuse.js
6. Cross-reference links from frontmatter
7. Keyboard shortcuts (Cmd+K search, arrow keys)
8. Hot reload for markdown changes

### Long Term (Sprint 3+)
9. Version history integration
10. Export options (PDF, Markdown bundle)
11. Comments/annotations
12. Multi-language support

---

## ğŸ“– Documentation

- **Full Implementation Plan:** `docs/documentation/IMPLEMENTATION-PLAN.md`
- **Session Logs:** `llm-context/SESSION-LOGS/`
- **README:** `docs/documentation/README.md`

---

*This file tracks the current state of the wiki implementation.*
*For detailed roadmap, see IMPLEMENTATION-PLAN.md*
